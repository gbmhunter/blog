---
import { LinkCard, CardGrid } from '@astrojs/starlight/components';
const {pages, excludes=[]} = Astro.props;

let childPageInfo = []
for (const page in pages) {
  const fileInfo = await pages[page]();
  const childPageFilePathParts = fileInfo.url.split('/');
  const childPageSlugPartial = childPageFilePathParts[childPageFilePathParts.length - 2];
  if (excludes.includes(childPageSlugPartial)) {
    continue;
  }
  // Astro.params.slug is undefined on the homepage
  let childPathSlug;
  if (Astro.params.slug === undefined) {
    childPathSlug = `/${childPageSlugPartial}/`;
  } else {
    childPathSlug = `/${Astro.params.slug}/${childPageSlugPartial}/`;
  }
  childPageInfo.push({
      title: fileInfo.frontmatter.title,
      url: childPathSlug,
      description: fileInfo.frontmatter.description,
  });
}
// console.log(Astro.params); // slug: electronics/circuit-design
// console.log(Astro.url); // pathaame: /electronics/circuit-design/
---

<CardGrid>
  {childPageInfo.map((childPageInfo) => (
    <LinkCard title={childPageInfo.title} href={childPageInfo.url} description={childPageInfo.description} />
  ))}
</CardGrid>
