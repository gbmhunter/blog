---
authors: [gbmhunter]
date: 2014-02-08
description: GitLab is a web-based Git repository manager and a strong competitor to GitHub, especially for commercial uses.
lastUpdated: 2024-10-02
tags: [GitLab, Git, version control, CI/CD, continuous integration, continuous deployment, yaml, container registry, local pipelines, GCL]
title: GitLab
type: page
---

<WarningIsNotes />

## Container Registries

Each repo can have it's own container registry. You can use this to store Docker images relating to the project.

`CI_REGISTRY_IMAGE` is provided and is the base path for the container registry.

You can log into the repo's container registry inside a pipeline with the command:

```bash
echo $CI_REGISTRY_PASSWORD | docker login -u $CI_REGISTRY_USER $CI_REGISTRY --password-stdin
```

Then you be able to push a built image:

```bash
docker push "$CI_REGISTRY_IMAGE"
```

You can download images from the GitLab container registry to your local machine by first logging in:

```bash
docker login registry.gitlab.com
```

You will be prompted to enter your username and password. If you have 2FA enabled, you will have to substitute your password with a personal access token.

You can then download and run an image with:

```bash
docker run -it registry.gitlab.com/<org_name>/<project_path> bash
```

## Includes

You can include files in your `.gitlab-ci.yml` file with the `include` keyword. This is useful for sharing common configuration between multiple projects.

```yaml
include:
  - project: 'my-group/my-project'
    file: '/path/to/file.yml'
```

You can also use the `ref` to specify a branch, tag or commit SHA when including a file. This is good for "version control" of your include dependencies.

```yaml
include:
  - project: 'my-group/my-project'
    ref: 'main' # Branch name
    file: '/path/to/file.yml'
  - project: 'my-group/my-project'
    ref: 'v1.0.0' # Tag name
    file: '/path/to/file.yml'
  - project: 'my-group/my-project'
    ref: 'b6901dcb0918db67a81b190d24fa67f0b5f99fdb' # Commit SHA
    file: '/path/to/file.yml'
```

## Running Pipelines Locally

GitLab does not have official support for running pipelines locally, but there is a popular third-party tool called [gitlab-ci-local](https://github.com/firecow/gitlab-ci-local) (a.k.a. GCL) which allows you to do this.

### Running a Job

Clone the repository that contains the pipeline (i.e. has a `.gitlab-ci.yml` file) and run the following command:

```bash
gitlab-ci-local <job_name>
```

This will run the job (and all of it's dependencies) locally and output the results to the console. You may need authentication for the job to run successfully, see the section below for details.

### Authentication

Normal pipelines that are run on GitLab's servers get provided with a `CI_JOB_TOKEN` which can be used to authenticate when pulling submodules that are other private GitLab repositories, or when pulling/pushing to the GitLab container registry. To authenticate when running locally, you can create a file called `.gitlab-ci-local-variables.yml` in the root directory of the repository with the following contents:

```yaml title=".gitlab-ci-local-variables.yml"
---
CI_JOB_TOKEN: <your_personal_access_token>
```

Do not commit this file to the repository! Make sure to add it to your `.gitignore` file.

### Manual Jobs

You can trigger a manual job to run during the execution of another job with `--manual <job_name>`. For example:

```bash
gitlab-ci-local build_firmware --manual my_manual_job
```

### Watch Out For Untracked Files

GCL will not sync local files that are not tracked by Git. So if you are playing around and add a completely new file, you might run into a "file not found" error when running your pipeline. To fix this, all you need to do is run `git add ...` to stage the file in git (it doesn't need to be committed)[^github-repo-gitlab-ci-local].

The file does not need to be continuously re-added to the git staging area when changes are made, as long as the file has been staged (or committed) at least once.

{/* ======================================================================== */}
{/* REFERENCES */}
{/* ======================================================================== */}

[^github-repo-gitlab-ci-local]: GitHub. _firecow/gitlab-ci-local_ [repo README]. Retrieved 2024-10-02, from https://github.com/firecow/gitlab-ci-local.
